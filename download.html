<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub Releases</title>
    <style>
        .release-info {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .download-button {
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div id="release-info"></div>

    <script>
        async function fetchReleaseInfo() {
            const { owner, repo } = { owner: 'akaina0112', repo: 'Test' }; // GitHubのオーナー名とリポジトリ名を入力してください
            const fileNames = ['20230704_185437.jpg', '20230704_185437.jpg']; // ダウンロード数を取得したいファイル名を指定してください

            const releaseInfoContainer = document.getElementById('release-info');
            releaseInfoContainer.innerHTML = ''; // 前回のリリース情報をクリア

            for (const fileName of fileNames) {
                try {
                    const releaseData = await fetch(`https://api.github.com/repos/${owner}/${repo}/releases`);
                    const releases = await releaseData.json();
                    let downloadCount = 0;
                    let downloadUrl = '';

                    for (const release of releases) {
                        for (const asset of release.assets) {
                            if (asset.name === fileName) {
                                downloadCount += asset.download_count;
                                downloadUrl = asset.browser_download_url;
                            }
                        }
                    }

                    const releaseInfo = `
                        <div class="release-info">
                            <p>ダウンロード数: ${downloadCount}</p>
                            <button class="download-button" onclick="window.open('${downloadUrl}', '_blank')">Download ${fileName}</button>
                        </div>`;
                    releaseInfoContainer.innerHTML += releaseInfo;
                } catch (error) {
                    console.error(`Error fetching ${fileName} info:`, error);
                }
            }
        }

        fetchReleaseInfo(); // 初回読み込み時にリリース情報を取得

        setInterval(fetchReleaseInfo, 30000); // 30秒ごとにリリース情報を更新
    </script>
</body>
</html>
