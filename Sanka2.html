<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Music Player</title>
</head>
<body>

<script>
window.onload = function() {
    // ModaalのCSSを読み込む
  const modaalCSS = document.createElement('link');
  modaalCSS.rel = 'stylesheet';
  modaalCSS.type = 'text/css';
  modaalCSS.href = 'https://cdnjs.cloudflare.com/ajax/libs/Modaal/0.4.4/css/modaal.min.css';
  document.head.appendChild(modaalCSS);
    // jQueryを読み込む
  const jqueryScript = document.createElement('script');
  jqueryScript.src = 'https://code.jquery.com/jquery-3.4.1.min.js';
  jqueryScript.integrity = 'sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=';
  jqueryScript.crossOrigin = 'anonymous';
  document.head.appendChild(jqueryScript);

  // Modaalを読み込む
  const modaalScript = document.createElement('script');
  modaalScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/Modaal/0.4.4/js/modaal.min.js';
  document.head.appendChild(modaalScript);

  // jQuery Cookieを読み込む
  const jqueryCookieScript = document.createElement('script');
  jqueryCookieScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js';
  document.head.appendChild(jqueryCookieScript);
  
    // Sale情報のセクションを作成して追加
  const saleInfoSection = document.createElement('section');
  saleInfoSection.id = 'info';

  const heading = document.createElement('h2');
  heading.textContent = 'Sale情報';

  const paragraph = document.createElement('p');
  paragraph.textContent = '11月1日～12月31日まで年末セールを開催！';

  saleInfoSection.appendChild(heading);
  saleInfoSection.appendChild(paragraph);

  // コンテナ要素に追加する
//  const container = document.getElementById('container');
//  container.appendChild(saleInfoSection);
  
  // コンテンツ領域のスタイルをJavaScriptで設定する
  const content = document.createElement('div');
  content.classList.add('content');
  content.style.padding = '20px';
  content.style.marginTop = '20vh'; /* コンテンツを上にオフセット */
  content.style.textAlign = 'center';
  content.style.color = 'white';
  content.style.fontSize = '24px';
  content.style.zIndex = '1'; /* コンテンツが背景の上に表示されるように設定 */
  content.textContent = '音楽を再生する';
  document.body.appendChild(content);

  // JavaScriptで要素を作成する
  const container = document.createElement('div');
  container.id = 'container';

  const mainimg = document.createElement('aside');
  mainimg.id = 'mainimg';

  const slide1 = document.createElement('div');
  slide1.classList.add('slide1');
  slide1.textContent = 'slide1';
  const slide2 = document.createElement('div');
  slide2.classList.add('slide2');
  slide2.textContent = 'slide2';

  mainimg.appendChild(slide1);
  mainimg.appendChild(slide2);
  container.appendChild(mainimg);
  document.body.appendChild(container);

  // JavaScriptでCSSスタイルを適用する場合
  const style = document.createElement('style');
  style.textContent = `
  *{text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);}
    /* CSSスライドショー設定 */
    @keyframes slide1 {
      0% { opacity: 1; transform: scale(1.2); }
      10% { opacity: 1; }
      20% { opacity: 1; }
      50% { opacity: 1; }
      60% { opacity: 1; }
      100% { opacity: 1; transform: scale(1.7); animation: slide2 5s linear forwards; }
    }

    @keyframes slide2 {
      0% { opacity: 1; transform: scale(1.7); }
      10% { opacity: 1; }
      20% { opacity: 1; }
      50% { opacity: 1; }
      60% { opacity: 1; }
      100% { opacity: 1; transform: scale(1.2); animation: slide1 5s linear forwards; }
    }

    /* 画像ブロック */
    #mainimg {
      clear: left;
      text-indent: -9999px;
      position: fixed; /* スクロールしても固定表示させる指定 */
      top: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    /* １枚目 */
    .slide1 {
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
      background-color: #464646;
      animation-timing-function: linear;
      animation-duration: 15s; /* 実行する時間。「s」は秒の事。 */
      animation-iteration-count: infinite; /* 実行する回数。「infinite」は無限に繰り返す意味。 */
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      animation-fill-mode: both;
      animation-delay: 1s;
      background: url(./background.png) no-repeat center center/cover;
      animation-name: slide1; /* 上で設定しているキーフレーム（keyframes）の名前 */
    } 
    /* 2枚目 */
    .slide2 {
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      background-size: cover;
      background-color: #464646;
      animation-timing-function: linear;
      animation-duration: 15s; /* 実行する時間。「s」は秒の事。 */
      animation-iteration-count: infinite; /* 実行する回数。「infinite」は無限に繰り返す意味。 */
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      animation-fill-mode: both;
      animation-delay: 1s;
      background: url(./background.png) no-repeat center center/cover;
      animation-name: slide2; /* 上で設定しているキーフレーム（keyframes）の名前 */
    }

    .music-info {
      display: none; /* 初期状態では非表示 */
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.7); /* 背景色を濃くしてコントラストを高める */
      color: white;
      padding: 20px 30px; /* パディングを増やして読みやすくする */
      border-radius: 8px; /* 角を丸くする */
      font-size: 16px; /* フォントサイズを大きくする */
      font-weight: bold; /* フォントウェイトを太くする */
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* シャドウを追加して視認性を高める */
      text-align: center; /* テキストを中央揃え */
      z-index: 9999; /* 最前面に表示 */
      transition: top 0.3s ease, opacity 0.3s ease; /* トランジション効果を追加 */
      /* テキストを光らせる効果 */
  　　text-shadow: 0 0 10px rgba(255, 255, 255, 0.8); /* 白色のぼかしを追加して光らせる */
    }

    /* 表示用のクラス */
    .show {
      display: block;
      top: 20px;
      opacity: 1;
    }#info{
	display: none;
}

/*モーダルの横幅を変更したい場合*/
.modaal-container{
    max-width: 600px;
}

/*モーダルのボタンの色を変更したい場合*/
.modaal-close:after, 
.modaal-close:before{
	background:#ccc;	
}

.modaal-close:focus:after,
.modaal-close:focus:before,
.modaal-close:hover:after,
.modaal-close:hover:before{
	background:#666;
}
  `;

  // head要素にスタイルを追加する
  document.head.appendChild(style);

  // 音楽プレーヤーを作成し再生する関数
  function createAndPlayAudio() {
    // 音楽プレーヤーを作成
    const audioElement = document.createElement('audio');
    audioElement.id = 'musicplayer';
    audioElement.loop = true; // ループ再生
    audioElement.volume = 0.2; // 音量設定

    // 音楽ファイルの設定
    const sourceElement = document.createElement('source');
    sourceElement.src = 'https://akaina0112.github.io/Test/bgm.mp3';
    sourceElement.type = 'audio/mpeg';

    audioElement.appendChild(sourceElement); // <audio>要素に音楽ファイルを追加
    document.body.appendChild(audioElement); // <body>要素に<audio>要素を追加

    // 音楽情報を表示する要素を作成
    const musicInfo = document.createElement('div');
    musicInfo.classList.add('music-info');
    musicInfo.textContent = '音楽名: Nightcore - Vicetone - Nevada'; // 音楽名を設定
    document.body.appendChild(musicInfo); // <body>要素に<div>要素を追加

    // 音楽情報の表示を通知風に
    setTimeout(() => {
      musicInfo.classList.add('show'); // 'show'クラスを追加して表示
      console.log('音楽名を表示');
    }, 50); // 少し遅延させて表示（ミリ秒単位）

    // 5秒後に音楽情報を消す
    setTimeout(() => {
      musicInfo.classList.remove('show'); // 'show'クラスを削除して非表示
      console.log('音楽名を消去');
    }, 4100); // 5秒後に消えるように設定（ミリ秒単位）


    // 音楽を再生する
    audioElement.play().then(() => {
      console.log('音楽が再生されました');
    }).catch(error => {
      console.log('音楽の再生に失敗しました:', error);
    });

    // イベントリスナーを削除（再生が開始されたら不要）
    document.body.removeEventListener('click', createAndPlayAudio);
  }

  // ページをクリックしたときに createAndPlayAudio 関数を実行
  document.body.addEventListener('click', createAndPlayAudio);

  // アニメーションを切り替え関数
  function switchSlide() {
    slide1.style.opacity = '1'; // 初期状態でslide1を表示

    slide1.addEventListener('animationend', function() {
      // slide1のアニメーションが終了したら、次の画像（slide2）へ切り替える
      slide1.style.opacity = '0'; // 現在の画像をフェードアウトさせる
      slide2.style.opacity = '1'; // 次の画像をフェードインさせる
      slide1.style.animation = 'none'; // アニメーションをリセット
      slide2.style.animation = 'slide2 5s linear forwards'; // slide2のアニメーションを開始
    });

    slide2.addEventListener('animationend', function() {
      // slide2のアニメーションが終了したら、次の画像（slide1）へ切り替える
      slide2.style.opacity = '0'; // 現在の画像をフェードアウトさせる
      slide1.style.opacity = '1'; // 次の画像をフェードインさせる
      slide2.style.animation = 'none'; // アニメーションをリセット
      slide1.style.animation = 'slide1 5s linear forwards'; // slide1のアニメーションを開始
    });

    // 初期アニメーションを開始
    slide1.style.animation = 'slide1 5s linear forwards';
  }

  // アニメーションを切り替え関数を要素作成後に実行
  switchSlide(); 
switchSlide2();
};
   function switchSlide2() {
	var access = $.cookie('access')
	if(!access){
		flag = true;
		$.cookie('access', false);
	}else{
		flag = false	
	}
	
	//モーダル表示
	$(".modal-open").modaal({
	start_open:flag, // ページロード時に表示するか
	overlay_close:true,//モーダル背景クリック時に閉じるか
	before_open:function(){// モーダルが開く前に行う動作
		$('html').css('overflow-y','hidden');/*縦スクロールバーを出さない*/
	},
	after_close:function(){// モーダルが閉じた後に行う動作
		$('html').css('overflow-y','scroll');/*縦スクロールバーを出す*/
	}
	});
   }
</script>
</body>
</html>
